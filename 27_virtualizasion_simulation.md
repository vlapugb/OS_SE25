# Уровни виртуализации и эмуляции: назначение и особенности

## 1. Общие понятия виртуализации и эмуляции

**Виртуализация** и **эмуляция** — технологии, позволяющие запускать программное обеспечение в изолированной или абстрагированной среде, отличной от реального аппаратного окружения.

Цели использования:
- изоляция и безопасность;
- эффективное использование ресурсов;
- переносимость ПО;
- тестирование и отладка;
- поддержка устаревших систем.

---

## 2. Эмуляция

### 2.1 Определение эмуляции

**Эмуляция** — полное воспроизведение аппаратной архитектуры или платформы в программном виде.

Гостевая система:
- не знает, что работает в эмуляторе;
- может быть рассчитана на другую архитектуру CPU.

Пример: запуск ARM-системы на x86-хосте.

---

### 2.2 Особенности эмуляции

- Полная интерпретация или динамическая трансляция инструкций.
- Значительные накладные расходы.
- Высокая совместимость.
- Низкая производительность по сравнению с виртуализацией.

---

### 2.3 Примеры эмуляции

- QEMU (full emulation);
- Bochs;
- эмуляторы игровых консолей;
- DOSBox.

---

## 3. Уровни виртуализации

Виртуализация может осуществляться на разных уровнях системы.

---

## 4. Аппаратная виртуализация (Hardware-level)

### 4.1 Суть аппаратной виртуализации

Виртуализация на уровне аппаратуры с поддержкой процессора.

Используются специальные расширения:
- Intel VT-x;
- AMD-V;
- ARM Virtualization Extensions.

Гостевая ОС выполняется почти напрямую на CPU.

---

### 4.2 Назначение

- Высокая производительность;
- Минимальные накладные расходы;
- Поддержка серверных нагрузок.

---

### 4.3 Примеры

- KVM;
- VMware ESXi;
- Hyper-V;
- Xen (HVM).

---

## 5. Виртуализация на уровне гипервизора

### 5.1 Типы гипервизоров

**Гипервизор типа 1 (bare-metal)**:
- работает напрямую на «железе»;
- управляет ресурсами без хост-ОС.

**Гипервизор типа 2 (hosted)**:
- работает как приложение в хост-ОС;
- использует её драйверы.

---

### 5.2 Назначение

- Изоляция виртуальных машин;
- Консолидация серверов;
- Централизованное управление.

---

### 5.3 Примеры

- Тип 1: ESXi, Xen, Hyper-V Server;
- Тип 2: VirtualBox, VMware Workstation.

---

## 6. Виртуализация на уровне операционной системы

### 6.1 Контейнерная виртуализация

Контейнеры используют:
- общее ядро ОС;
- изоляцию процессов;
- namespace и cgroups.

---

### 6.2 Особенности

- Очень малая накладная стоимость;
- Быстрый запуск;
- Ограниченная изоляция по сравнению с ВМ.

---

### 6.3 Назначение

- Микросервисная архитектура;
- DevOps и CI/CD;
- Масштабирование приложений.

---

### 6.4 Примеры

- Docker;
- LXC/LXD;
- Podman;
- Kubernetes (оркестрация).

---

## 7. Виртуализация на уровне библиотек и API

### 7.1 Суть подхода

Перехват и переопределение API:
- системных вызовов;
- библиотечных функций.

---

### 7.2 Назначение

- Запуск ПО без полной виртуализации;
- Совместимость приложений.

---

### 7.3 Примеры

- Wine (Windows API на Linux);
- POSIX layers;
- Android Runtime (ART).

---

## 8. Виртуализация на уровне приложений

### 8.1 Определение

Изоляция и упаковка отдельных приложений вместе с зависимостями.

---

### 8.2 Назначение

- Упрощение распространения ПО;
- Независимость от среды;
- Повышение безопасности.

---

### 8.3 Примеры

- Flatpak;
- Snap;
- AppImage.

---

## 9. Сравнение уровней

| Уровень | Производительность | Совместимость | Изоляция |
|-------|------------------|---------------|----------|
| Эмуляция | Низкая | Очень высокая | Полная |
| Аппаратная виртуализация | Высокая | Высокая | Полная |
| Контейнеры | Очень высокая | Средняя | Частичная |
| API-виртуализация | Очень высокая | Ограниченная | Низкая |

---

## 10. Итог

- **Эмуляция** обеспечивает максимальную совместимость ценой производительности.
- **Виртуализация** имеет несколько уровней — от аппаратного до прикладного.
- Выбор уровня определяется требованиями к изоляции, скорости и совместимости.
- Современные системы часто комбинируют несколько подходов.

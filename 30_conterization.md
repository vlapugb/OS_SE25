# Контейнеризация в операционных системах

## 1. Понятие контейнеризации

**Контейнеризация** — это технология изоляции приложений на уровне операционной системы, при которой несколько изолированных сред (контейнеров) работают на одном ядре ОС.

Контейнер включает:
- приложение;
- его зависимости;
- библиотеки и конфигурации.

При этом контейнер **не содержит собственного ядра ОС**.

---

## 2. Отличие контейнеризации от виртуализации

Основные различия:
- контейнеры используют общее ядро хост-ОС;
- виртуальные машины имеют собственное ядро;
- контейнеры легче и запускаются быстрее.

Контейнеризация считается формой **виртуализации уровня ОС**.

---

## 3. Основные механизмы контейнеризации в ядре ОС

Контейнеризация реализуется с помощью механизмов ядра.

---

### 3.1 Namespaces

**Namespaces** обеспечивают изоляцию ресурсов между контейнерами.

Основные типы namespace:
- **PID namespace** — изоляция идентификаторов процессов;
- **Mount namespace** — изоляция файловых систем;
- **Network namespace** — изоляция сетевых интерфейсов;
- **IPC namespace** — изоляция межпроцессного взаимодействия;
- **UTS namespace** — изоляция hostname;
- **User namespace** — изоляция пользователей и прав.

Каждый контейнер видит только свои ресурсы.

---

### 3.2 Cgroups (Control Groups)

**Cgroups** ограничивают и учитывают использование ресурсов.

Позволяют:
- ограничивать CPU;
- ограничивать память;
- контролировать I/O;
- учитывать потребление ресурсов.

Cgroups предотвращают монополизацию ресурсов одним контейнером.

---

### 3.3 Capabilities

**Linux capabilities** позволяют:
- разделять привилегии root;
- выдавать контейнерам только необходимые права;
- повышать безопасность.

Пример: контейнер может управлять сетью, но не монтировать файловые системы.

---

## 4. Файловая система контейнеров

Контейнеры используют:
- **union filesystem**;
- слоистую структуру образов.

Популярные файловые системы:
- OverlayFS;
- AUFS;
- Btrfs;
- ZFS.

Преимущества:
- повторное использование слоёв;
- экономия места;
- быстрый запуск контейнеров.

---

## 5. Жизненный цикл контейнера

Типовые этапы:
1. Создание контейнера из образа.
2. Настройка namespace и cgroups.
3. Запуск процесса init контейнера.
4. Работа приложения.
5. Остановка и удаление контейнера.

Контейнер существует, пока работает его основной процесс.

---

## 6. Сетевое взаимодействие контейнеров

Контейнеры могут использовать:
- bridge-сети;
- virtual ethernet (veth);
- overlay-сети;
- host-сеть.

Каждый контейнер может иметь:
- собственный IP-адрес;
- изолированный сетевой стек.

---

## 7. Контейнерные образы

**Контейнерный образ** — неизменяемый шаблон контейнера.

Содержит:
- базовую ОС (минимальную);
- приложение;
- зависимости;
- метаданные.

Образы хранятся в реестрах:
- Docker Hub;
- private registry.

---

## 8. Инструменты контейнеризации

### 8.1 Контейнерные движки

- Docker;
- Podman;
- containerd;
- CRI-O.

---

### 8.2 Оркестрация контейнеров

**Оркестрация** — управление множеством контейнеров.

Функции:
- автоматический запуск и перезапуск;
- масштабирование;
- балансировка нагрузки;
- обновления без простоя.

Примеры:
- Kubernetes;
- Docker Swarm;
- Nomad.

---

## 9. Преимущества контейнеризации

- Быстрый запуск.
- Низкие накладные расходы.
- Высокая плотность размещения.
- Удобство доставки приложений.
- Хорошая интеграция с CI/CD.

---

## 10. Недостатки контейнеризации

- Общее ядро — потенциальный риск безопасности.
- Ограниченная изоляция по сравнению с ВМ.
- Зависимость от версии ядра ОС.
- Сложность отладки.

---

## 11. Области применения

- Микросервисная архитектура.
- Облачные платформы.
- DevOps и CI/CD.
- Тестирование и разработка.
- High-load системы.

---

## 12. Итог

Контейнеризация:
- обеспечивает лёгкую и быструю изоляцию приложений;
- использует механизмы ядра ОС (namespaces, cgroups);
- является ключевой технологией современных облачных и серверных систем.
